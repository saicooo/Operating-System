/*
 * ======================================================================
 * Лабораторная работа 2, задание 5.1 (планирование процессов)
 * ======================================================================
 *
 * ЗАДАЧА:
 * Определение политики планирования и приоритета, установленных по 
 * умолчанию, для процессов, запускаемых пользователем из shell. Анализ
 * очередности исполнения процессов при различных приоритетах и политиках.
 *
 * ЧТО ДЕЛАЕТ ПРОГРАММА:
 * Программа schedule определяет текущую политику планирования и приоритет
 * процесса программным способом. Получает и выводит информацию о текущей
 * политике планирования (SCHED_OTHER, SCHED_FIFO, SCHED_RR), приоритете
 * и допустимых диапазонах значений для разных типов планировщиков.
 *
 * КОМПИЛЯЦИЯ И ЗАПУСК:
 * $ gcc schedule.c -o schedule
 * $ ./schedule
 *
 * РЕЗУЛЬТАТЫ И ВЫВОДЫ:
 * - Показывает, что процессы пользователя обычно запускаются с политикой
 *   планирования SCHED_OTHER (стандартная политика).
 * - Определяет значение nice по умолчанию для пользовательских процессов.
 * - Подтверждает, что для обычных пользовательских процессов используется
 *   планировщик с разделением времени на основе nice значений.
 */

#include <sched.h>
#include <stdio.h>
#include <sys/resource.h>
#include <unistd.h>

int main() {
    // Отключаем буферизацию
    setbuf(stdout, NULL);
    setbuf(stderr, NULL);

    // Получаем политику планирования
    int                policy = sched_getscheduler(0);
    struct sched_param param;
    sched_getparam(0, &param);

    // Определяем тип политики планирования
    printf("\n--- Текущая политика планирования ---\n");
    switch (policy) {
        case SCHED_OTHER:
            printf("SCHED_OTHER (стандартная)\n");
            // Получить nice значение
            printf("Nice значение: %d\n", getpriority(PRIO_PROCESS, 0));
            break;
        case SCHED_FIFO:
            printf("SCHED_FIFO (реального времени)\n");
            printf("Приоритет реального времени: %d\n", param.sched_priority);
            break;
        case SCHED_RR:
            printf("SCHED_RR (реального времени с квантованием)\n");
            printf("Приоритет реального времени: %d\n", param.sched_priority);
            break;
        default:
            printf("Неизвестная политика (%d)\n", policy);
            break;
    }

    return 0;
}