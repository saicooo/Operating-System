/*
 * ======================================================================
 * Лабораторная работа 2, задание 2.2 (дочерний процесс)
 * ======================================================================
 *
 * ЗАДАЧА:
 * Программа потомка, запускаемая через execl() из родительского процесса.
 * Демонстрация замены образа процесса и фиксация таблицы процессов.
 *
 * ЧТО ДЕЛАЕТ ПРОГРАММА:
 * 1. Выводит свой PID и PPID (который будет равен PID родительского процесса)
 * 2. Выполняет команду ps -l для вывода таблицы процессов
 * 3. Выводит сообщение о завершении работы
 * 4. Завершается с кодом 0 (успех)
 *
 * КОМПИЛЯЦИЯ И ЗАПУСК:
 * $ gcc son.c -o son
 * (Обычно запускается из father.c через execl, но можно запустить и напрямую)
 * $ ./son
 *
 * ОСОБЕННОСТИ:
 * - Этот файл демонстрирует результат системного вызова exec(), который
 *   заменяет текущий образ процесса новым, но сохраняет PID
 */

#include <stdio.h>
#include <stdlib.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <unistd.h>

int main() {
    // Отключаем буферизацию
    setbuf(stdout, NULL);
    setbuf(stderr, NULL);
    
    char cmd[256];
    sprintf(cmd, "\n--- Информация о son ---\nPID=[%d], PPID=[%d]\n\n", getpid(), getppid());
    printf("%s", cmd);

    // Добавляем разделитель и метку процесса
    sprintf(cmd, "echo '\n--- Вывод ps от процесса-потомка (PID=%d) ---' && ps -l", getpid());
    system(cmd);

    printf("Потомок завершил свою работу\n");
    return 0;
}